import{r as e,h as n,H as s}from"./p-6cbca430.js";import{I as t,s as o}from"./p-fe46a67d.js";function i(e,n,s){return function(e,n="Race",s="asc"){const t="asc"===s?1:-1;return e.sort(((e,s)=>e[n]>s[n]?t:-t))}(e,n,s)}const r=class{constructor(n){e(this,n),this.question=null,this.showNoResponse=!1,this.type=t.Choice,this.responses=[]}applyFilters(e){return o.filter&&0!==o.filter.length?e.filter((e=>e.Race.match(o.filter))):e}renderResponse(e,s=2){const o=this.applyFilters(e.candidates);if("No Response"!==e.response&&0!==o.length){let s=e.response.replace(/^[0-9]\.\s+/,"").replace(/(?:\r\n|\r|\n)/g,"<br>"),r="grid";switch(this.type){case t.Choice:return n("div",{class:"response-gallery"},n("dc-election-gallery",{appearance:r,candidates:i(o,"Race")},n("div",{class:"response",innerHTML:s})));case t.Text:return r="quote",n("div",{class:"response-quote"},n("dc-election-gallery",{appearance:r,candidates:i(o,"Race")}),n("div",{class:"response",innerHTML:s}));case t.Rank:case t.Option:r="quote";const e=s.split("|");return s=n("ol",{class:"rank-options"},e.map((e=>this.formatRankOptions(e)))),n("div",{class:"response-rank"},n("dc-election-gallery",{appearance:r,candidates:i(o,"Race")}),n("div",{class:"response"},s))}}else if(this.showNoResponse){const s=e.candidates.map((e=>null==e?void 0:e.Candidate));return n("div",{class:"footnote"},"No response from ",i(s).join(", "))}}formatRankOptions(e){let s="unranked";switch(!0){case/\~(.*)\~/g.test(e):s="omit";break;case/^#/.test(e):s="ranked",e=e.replace(/^#/,"")}return e=e.replace(/\~(.*)\~ (\([\w\s]+\))/g,"<span class='text'>$1</span> <span class='comment'>$2</span>"),n("li",{class:s,innerHTML:e=`<span>${e}</span>`})}renderQuestion(e){const s=e.Question.replace(/(?:\r\n|\r|\n)/g,"<br>");let t="",o=s;try{[,t,o]=s.match(/_(.*)_(.*)/)}catch(e){}return[n("span",{class:"preface",innerHTML:t}),n("span",{class:"focus",innerHTML:o})]}render(){return n(s,null,n("slot",null),this.renderQuestion(this.question),n("div",{class:`layout-${this.type.toLowerCase()}`},i(this.responses,"response","asc").map((e=>this.renderResponse(e,this.responses.length)))))}};r.style=':host{display:block;}.preface{font-weight:300;font-size:1em;display:block}.focus{font-weight:800;font-size:1.2em;padding-top:0.3em;padding-bottom:0.5em;position:sticky;background-color:white;opacity:0.9;top:0px;display:block}.response{font-weight:600;font-size:1em;padding:1em 0;margin-top:0.5em}.response-gallery .response::before{content:"\\203A"}.footnote{font-weight:300px;font-size:0.8em;font-style:italic;padding-top:0.5em}.layout-choice{display:grid;grid-gap:0.3em;grid-template-columns:repeat( auto-fit, minmax(400px, 1fr) )}.layout-choice .response{padding:0 0.3em 0.3em 0.3em;vertical-align:bottom}.response-quote,.response-rank{display:grid;grid-template-columns:0.1fr 1fr;padding:1em 0;border-bottom:thin solid #DDD}.response-rank .response{font-weight:300;padding:0}.response-quote .response{font-weight:400;font-size:1em;padding:0.4em;font-style:oblique;quotes:"\\201C""\\201D""\\2018""\\2019"}.response-quote .response:before{content:open-quote;color:#ccc;font-size:3em;line-height:0.1em;margin-right:0.25em;vertical-align:-0.4em}.response-quote .response:after{content:close-quote;color:#ccc;font-size:3em;line-height:0.1em;margin-right:0.25em;vertical-align:-0.4em}.rank-options{padding:0;margin:0;font:italic 1em Georgia;color:#666}.rank-options span{font:normal 1em Arial;color:#000}.rank-options li{border:1px solid #CCC;padding:0.5em;margin-left:1.5em;margin-bottom:0.5em}.rank-options .ranked{border:1px solid #0f9535}.rank-options li.omit,.rank-options li.unranked{list-style:none}.omit .text{font:normal 1em Arial;text-decoration:line-through;color:#555}.omit .comment{display:inline-block;text-decoration:unset;font-weight:100;padding-left:0.5em;font-style:italic}';export{r as dc_election_question}